{% extends 'ndr_core/result_renderers/styles/renderer_transcription_and_fragment.html' %}
{% load ndr_utils %}
{% load i18n %}

{% block result_tags %}

    <span  data-toggle="tooltip" data-placement="top" title="{{ result.original_data.snippet_type.id|translate_dict_info:'type' }}" class="badge badge-secondary small" style="font-weight: normal; background-color: {{ result.original_data.type.id|translate_to_color:30 }};">{{ result.original_data.snippet_type.id|translate_dict_value:'type' }}</span>

    {% if result.original_data.snippet_type.is_reprint %}
        <span class="badge badge-secondary small" style="font-weight: normal; background-color: #e4606d;">Reprint</span>
    {% else %}
        <span class="badge badge-secondary small" style="font-weight: normal; background-color: #4DC7A0;">Original</span>
    {% endif %}
    {% if result.original_data.snippet_type.additional_data.is_header %}
        <span class="badge badge-secondary small" style="font-weight: normal; background-color: #7abaff;">Header</span>
    {% endif %}
    {% if result.original_data.snippet_type.additional_data.is_advert %}
        <span class="badge badge-secondary small" style="font-weight: normal; background-color: #7abaff;">Advert</span>
    {% endif %}
    {% if result.original_data.snippet_type.additional_data.is_notice %}
        <span class="badge badge-secondary small" style="font-weight: normal; background-color: #7abaff;">Notice</span>
    {% endif %}
    {% if result.original_data.snippet_type.language %}
        <span class="badge badge-secondary small" style="font-weight: normal;">{{ result.original_data.snippet_type.language|translate_dict_value:'lang' }}</span>
    {% endif %}
{% endblock %}

{% block tags %}
    <p class="text-center pt-3">
        {% if result.original_data.tags.tags %}
            {% translate 'Categories:' %}
            {% with result.original_data.tags.tags as tag_list %}
                {% for tag in tag_list|clean_list %}
                    <span class="badge border border-secondary small text-dark"
                          style="font-weight: normal; background-color: {{ tag|translate_to_color:80 }};"
                          data-toggle="tooltip"
                          data-placement="top"
                          title="{{ tag|translate_dict_info:'tags' }}">{{ tag|translate_dict_value:'tags' }}</span>
                {% endfor %}
            {% endwith %}
        {% endif %}
    </p>
{% endblock %}

{% block title_line %}
    <i>{{ result.original_data.source.title }}</i>: <strong>{{ result.original_data.date.ref|format_date }}</strong>, Issue {{ result.original_data.source.issue }}, p. {{ result.original_data.source.selector.page }}
{% endblock %}

{% block text %}
        <p class="text-center bg-light border rounded p-3">
            "{{ result.original_data.transcription.original }}"
        </p>

{% endblock %}

{% block fragment_image %}
    <p class="text-center p-3 border rounded">
        {% if result.original_data.source.selector.fragment|is_list %}
            {% for frag in result.original_data.source.selector.fragment %}
                {% if frag %}
                    <img class="img-fluid" src="{{ frag|reduce_iiif_size:25 }}" alt="IIIF fragment">
                {% endif %}
            {% endfor %}
        {% else %}
            {% if result.original_data.source.selector.fragment|reduce_iiif_size:25 != '' %}
                <img class="img-fluid" src="{{ result.original_data.source.selector.fragment|reduce_iiif_size:25 }}" alt="IIIF fragment">
            {% else %}
                {% translate '(no image found)' %}
            {% endif %}
        {% endif %}

    </p>
{% endblock %}

{% block citation_info %}
    {% translate 'Cite:' %}
    <span id="copyTarget_{{ result.original_data.source.id|url_parse }}">
        {{ result.original_data.source.title }}, {{ result.original_data.date.ref }} (Issue {{ result.original_data.source.issue }}), p. {{ result.original_data.source.selector.page }}, {{ result.original_data.source.collection }}
    </span>
{% endblock %}
